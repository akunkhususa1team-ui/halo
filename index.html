<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Untuk Aila ğŸ’˜</title>
    <style>
        :root{ --pink:#ff3d7f; --soft:#ff9bbb; --dark:#120012; --card:rgba(255,255,255,.14); }
        *{margin:0;padding:0;box-sizing:border-box}
        html,body{width:100%;height:100%;font-family:"Segoe UI",Arial,sans-serif; overflow:hidden;}
        body{ background:radial-gradient(circle at top,var(--soft),var(--dark)); display:flex; flex-direction:column; color:white; }

        /* OPENING */
        #opening{ position:fixed; inset:0; background:rgba(0,0,0,.85); backdrop-filter:blur(20px); display:grid; place-items:center; font-size:24px; cursor:pointer; z-index:9999; transition:0.8s; }
        .fade-out{opacity:0; pointer-events:none}

        /* CONTAINER & CARD */
        .container{ flex:1; display:flex; align-items:center; justify-content:center; padding:15px; z-index:10; min-height: 0; }
        .card{ 
            width:100%; max-width:380px; background:var(--card); backdrop-filter:blur(15px); 
            border-radius:30px; padding:25px 20px; text-align:center; 
            box-shadow:0 20px 50px rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.1);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }

        h1{ font-size:clamp(24px, 7vw, 32px); margin-bottom:15px; text-shadow:0 2px 10px rgba(0,0,0,0.3); }
        
        /* PHOTO WRAPPER - UKURAN DEFAULT BESAR */
        .photo-wrapper {
            width: 240px; height: 240px; margin: 0 auto;
            position: relative; transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); z-index: 100;
        }
        .photo {
            width: 100%; height: 100%; border-radius: 20px; object-fit: cover;
            box-shadow: 0 0 25px var(--pink); cursor: pointer;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        /* Mode Portrait */
        .is-portrait { width: 260px !important; height: 380px !important; }

        /* TEXT & BUTTON ANIMATION */
        h2#question { font-size: 18px; font-weight: 400; margin: 20px 0; transition: all 0.5s ease; }
        .buttons { position: relative; width: 100%; height: 100px; transition: all 0.5s ease; }
        .push-down { transform: translateY(20px); }

        /* BUTTONS STYLE */
        button { padding: 12px 25px; border-radius: 15px; border: none; cursor: pointer; position: absolute; font-weight: bold; transition: 0.2s; font-size: 16px; }
        #yesBtn { left: 10%; background: var(--pink); color: white; box-shadow: 0 5px 15px var(--pink); }
        #noBtn { right: 10%; background: #444; color: white; }

        /* DISMISS OVERLAY */
        #dismiss-overlay { position: fixed; inset: 0; z-index: 50; display: none; }

        /* SPARKLE & RUNNING TEXT */
        .sparkle { position: fixed; pointer-events: none; animation: fly 1s forwards cubic-bezier(0.165, 0.84, 0.44, 1); z-index: 1000; }
        @keyframes fly {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            100% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.6); opacity: 0; }
        }
        .running { background: var(--pink); padding: 12px 0; overflow: hidden; white-space: nowrap; z-index: 100; position: relative; flex-shrink: 0; }
        .running span { display: inline-block; padding-left: 100%; animation: scroll 15s linear infinite; font-weight: bold; }
        @keyframes scroll { to { transform: translateX(-100%); } }

        .heart-rain { position: fixed; top: -20px; animation: fall linear forwards; pointer-events: none; z-index: 5; }
        @keyframes fall { to { transform: translateY(110vh); opacity: 0; } }
    </style>
</head>
<body>

    <div id="opening">âœ¨ Klik untuk Aila âœ¨</div>
    <div id="dismiss-overlay"></div>

    <div class="container">
        <div class="card" id="mainCard">
            <h1>Untuk Aila ğŸ’–</h1>
            <div class="photo-wrapper" id="pWrapper">
                <img src="foto.jpg" class="photo" id="mainPhoto" alt="Aila">
            </div>
            <h2 id="question">Mau jalan sama aku nggak? ğŸ¥º</h2>
            <div class="buttons" id="btnArea">
                <button id="yesBtn">Yes ğŸ˜</button>
                <button id="noBtn">No ğŸ˜œ</button>
            </div>
        </div>
    </div>

    <div class="running">
        <span>ğŸ’˜ Happy Valentine Aila ğŸ’˜ Semangat terus yaa! ğŸ’˜ Senyum dong! ğŸ˜œ ğŸ’˜ ini cuma iseng-iseng bikin gini an wkwk ğŸ’˜</span>
    </div>

    <audio id="music" loop preload="auto"><source src="Timur.mp3" type="audio/mpeg"></audio>
    <audio id="music2" preload="auto"><source src="MyEverything.mp3" type="audio/mpeg"></audio>

<script>
    const wrapper = document.getElementById("pWrapper");
    const photo = document.getElementById("mainPhoto");
    const question = document.getElementById("question");
    const btnArea = document.getElementById("btnArea");
    const opening = document.getElementById("opening");
    const overlay = document.getElementById("dismiss-overlay");
    const music = document.getElementById("music");
    const music2 = document.getElementById("music2");

    // FUNGSI ZOOM & DISMISS
    function togglePortrait(show, e = null) {
        if (show) {
            wrapper.classList.add("is-portrait");
            question.classList.add("push-down");
            btnArea.classList.add("push-down");
            overlay.style.display = "block";
            if(e) createSparks(e.clientX, e.clientY);
        } else {
            wrapper.classList.remove("is-portrait");
            question.classList.remove("push-down");
            btnArea.classList.remove("push-down");
            overlay.style.display = "none";
        }
    }

    photo.onclick = (e) => { e.stopPropagation(); togglePortrait(!wrapper.classList.contains("is-portrait"), e); };
    overlay.onclick = () => togglePortrait(false);
    document.querySelector('.container').onclick = (e) => { if(e.target !== photo) togglePortrait(false); };

    function createSparks(x, y) {
        const particles = ['âœ¨', 'â­', 'ğŸ’–', 'ğŸŒ¸', 'ğŸ’˜'];
        for (let i = 0; i < 20; i++) {
            const s = document.createElement('div');
            s.className = 'sparkle';
            s.innerHTML = particles[Math.floor(Math.random() * particles.length)];
            s.style.left = x + 'px'; s.style.top = y + 'px';
            const angle = Math.random() * Math.PI * 2;
            const dist = Math.random() * 150 + 50;
            s.style.setProperty('--x', Math.cos(angle) * dist + 'px');
            s.style.setProperty('--y', Math.sin(angle) * dist + 'px');
            document.body.appendChild(s);
            setTimeout(() => s.remove(), 1000);
        }
    }

    // OPENING - LOAD DAN JALANKAN AUDIO
    opening.onclick = async () => {
        opening.classList.add("fade-out");
        try {
            // Kita "pancing" music2 saat opening agar dapat izin browser
            music2.muted = true; 
            await music2.play();
            music2.pause();
            music2.muted = false;
            music2.currentTime = 0;
            
            await music.play();
        } catch (e) { console.log("Audio load error"); }
    };

    // LOGIKA TOMBOL NO
    const noBtn = document.getElementById("noBtn");
    function moveNo() {
        const maxX = btnArea.clientWidth - noBtn.offsetWidth;
        const maxY = btnArea.clientHeight - noBtn.offsetHeight;
        noBtn.style.left = Math.random() * maxX + "px";
        noBtn.style.top = Math.random() * maxY + "px";
    }
    ["mouseenter", "touchstart"].forEach(evt => noBtn.addEventListener(evt, (e) => { if(evt === "touchstart") e.preventDefault(); moveNo(); }));

    // LOGIKA TOMBOL YES - FIX AUDIO SWAP DEWA
    document.getElementById("yesBtn").onclick = async function() {
        // 1. Hentikan music 1
        music.pause();
        
        // 2. Gunakan sedikit jeda agar browser memproses pause sebelum play
        await new Promise(r => setTimeout(r, 100));

        // 3. Putar music 2 secara eksplisit
        try {
            music2.currentTime = 0;
            await music2.play();
        } catch (err) {
            // Jika gagal (jarang terjadi), pancing ulang
            music2.play();
        }

        const voice = new SpeechSynthesisUtterance("Yeayyyy! Aila mau jalan sama aku hehehehe");
        voice.lang = "id-ID"; speechSynthesis.speak(voice);

        document.body.style.transition = "opacity 0.8s";
        document.body.style.opacity = "0";
        setTimeout(() => {
            document.body.innerHTML = `<div class="container"><div class="card"><h1 style="color:#f0ddea"> YEAYYY ğŸ’•<br>Aila mau jalan sama aku hehe ğŸ˜†ğŸ’˜ </h1></div></div><div class="running"><span>ğŸ’– Assiiikkk seneng banget ğŸ’–ğŸ’– Senyum dikit gapapa si ğŸ˜œğŸ’–</span></div>`;
            document.body.style.opacity = "1";
        }, 800);
    };

    setInterval(() => {
        const h = document.createElement("div");
        h.className = "heart-rain"; h.innerHTML = "ğŸ’–";
        h.style.left = Math.random() * 100 + "vw";
        h.style.animationDuration = (Math.random() * 2 + 3) + "s";
        document.body.appendChild(h);
        setTimeout(() => h.remove(), 5000);
    }, 300);
</script>
</body>
</html>
